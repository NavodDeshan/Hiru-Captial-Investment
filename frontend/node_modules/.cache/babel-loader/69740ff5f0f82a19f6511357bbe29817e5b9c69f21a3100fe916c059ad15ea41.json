{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import axios from'axios';// Import axios for API requests\nimport'./../css/UserDashboard.css';// Ensure you have a CSS file for styling\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserDashboard=()=>{const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const navigate=useNavigate();// For redirection\nuseEffect(()=>{const fetchUserProfile=async()=>{try{// Retrieve id and token from local storage\nconst id=localStorage.getItem('id');const token=localStorage.getItem('token');console.log('Retrieved ID:',id);// Debugging: Check if ID is retrieved\nconsole.log('Retrieved Token:',token);// Debugging: Check if Token is retrieved\nif(!id||!token){setError('User ID or token not found. Redirecting to login...');setLoading(false);setTimeout(()=>navigate('/'),2000);// Redirect to login after 2 seconds\nreturn;}// Fetch user profile using id\nconst response=await axios.get(\"http://localhost:5000/api/users/user/profile/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)// Include token in the request\n}});console.log('User Profile Response:',response.data);// Debugging: Check API response\nsetUser(response.data);// Set the user data\nsetLoading(false);// Set loading to false\n}catch(err){console.error('Error fetching user profile:',err);// Debugging: Log the error\nif(err.response&&err.response.status===404){setError('User profile not found. Please check your account.');}else if(err.response&&err.response.status===401){setError('Unauthorized. Please log in again.');setTimeout(()=>navigate('/'),2000);// Redirect to login after 2 seconds\n}else{setError('Failed to fetch user profile. Please try again later.');}setLoading(false);// Set loading to false even if there's an error\n}};fetchUserProfile();},[navigate]);// Include navigate in dependency array\nconst handleLogout=()=>{// Clear local storage\nlocalStorage.removeItem('id');localStorage.removeItem('token');// Redirect to login page\nnavigate('/');};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[\"Error: \",error]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"user-dashboard\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"User Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-profile\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Profile\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Username:\"}),\" \",user.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",user.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Role:\"}),\" \",user.role]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-actions\",children:[/*#__PURE__*/_jsx(Link,{to:\"/AddLoan\",className:\"user-action\",children:\"Add Loans\"}),/*#__PURE__*/_jsx(Link,{to:\"/AddPayment\",className:\"user-action\",children:\"Add Payment\"})]})]});};export default UserDashboard;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","UserDashboard","user","setUser","loading","setLoading","error","setError","navigate","fetchUserProfile","id","localStorage","getItem","token","console","log","setTimeout","response","get","concat","headers","Authorization","data","err","status","handleLogout","removeItem","children","className","username","email","role","to"],"sources":["D:/hiru/Hiru-Captial-Investment/frontend/src/pages/UserDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport axios from 'axios'; // Import axios for API requests\r\nimport './../css/UserDashboard.css'; // Ensure you have a CSS file for styling\r\n\r\nconst UserDashboard = () => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate(); // For redirection\r\n\r\n  useEffect(() => {\r\n    const fetchUserProfile = async () => {\r\n      try {\r\n        // Retrieve id and token from local storage\r\n        const id = localStorage.getItem('id');\r\n        const token = localStorage.getItem('token');\r\n\r\n        console.log('Retrieved ID:', id); // Debugging: Check if ID is retrieved\r\n        console.log('Retrieved Token:', token); // Debugging: Check if Token is retrieved\r\n\r\n        if (!id || !token) {\r\n          setError('User ID or token not found. Redirecting to login...');\r\n          setLoading(false);\r\n          setTimeout(() => navigate('/'), 2000); // Redirect to login after 2 seconds\r\n          return;\r\n        }\r\n\r\n        // Fetch user profile using id\r\n        const response = await axios.get(`http://localhost:5000/api/users/user/profile/${id}`, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`, // Include token in the request\r\n          },\r\n        });\r\n\r\n        console.log('User Profile Response:', response.data); // Debugging: Check API response\r\n        setUser(response.data); // Set the user data\r\n        setLoading(false); // Set loading to false\r\n      } catch (err) {\r\n        console.error('Error fetching user profile:', err); // Debugging: Log the error\r\n\r\n        if (err.response && err.response.status === 404) {\r\n          setError('User profile not found. Please check your account.');\r\n        } else if (err.response && err.response.status === 401) {\r\n          setError('Unauthorized. Please log in again.');\r\n          setTimeout(() => navigate('/'), 2000); // Redirect to login after 2 seconds\r\n        } else {\r\n          setError('Failed to fetch user profile. Please try again later.');\r\n        }\r\n\r\n        setLoading(false); // Set loading to false even if there's an error\r\n      }\r\n    };\r\n\r\n    fetchUserProfile();\r\n  }, [navigate]); // Include navigate in dependency array\r\n\r\n  const handleLogout = () => {\r\n    // Clear local storage\r\n    localStorage.removeItem('id');\r\n    localStorage.removeItem('token');\r\n    // Redirect to login page\r\n    navigate('/');\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error-message\">Error: {error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"user-dashboard\">\r\n      <h1>User Dashboard</h1>\r\n\r\n      {/* User Profile Section */}\r\n      <div className=\"user-profile\">\r\n        <h2>User Profile</h2>\r\n        <p><strong>Username:</strong> {user.username}</p>\r\n        <p><strong>Email:</strong> {user.email}</p>\r\n        <p><strong>Role:</strong> {user.role}</p>\r\n      </div>\r\n\r\n      {/* User Actions Section */}\r\n      <div className=\"user-actions\">\r\n        <Link to=\"/AddLoan\" className=\"user-action\">Add Loans</Link>\r\n        <Link to=\"/AddPayment\" className=\"user-action\">Add Payment</Link>\r\n      </div>\r\n\r\n     \r\n      \r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}