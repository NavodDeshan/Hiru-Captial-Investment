{"ast":null,"code":"import _objectSpread from\"D:/hiru/Hiru-Captial-Investment/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';// Import axios for API requests\nimport'./../css/ViewAllUsers.css';// Correct path to ViewAllUsers.css\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ViewAllUsers=()=>{// State to hold the users and loading status\nconst[users,setUsers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[editUser,setEditUser]=useState(null);// Fetch all users from the backend when the component mounts\nuseEffect(()=>{const fetchUsers=async()=>{try{// Get the token from localStorage\nconst token=localStorage.getItem('token');if(!token){setError('No token found, please login.');setLoading(false);return;}// Send GET request to the backend with the Authorization header\nconst response=await axios.get('http://localhost:5000/api/users/users',{headers:{Authorization:\"Bearer \".concat(token)}});setUsers(response.data);// Store users in the state\nsetLoading(false);// Set loading to false when data is fetched\n}catch(err){setError('An error occurred while fetching users.');setLoading(false);// Set loading to false even if there's an error\n}};fetchUsers();},[]);// Empty dependency array ensures the effect runs only once after initial render\nconst handleDelete=async id=>{try{// Get the token from localStorage\nconst token=localStorage.getItem('token');if(!token){setError('No token found, please login.');return;}await axios.delete(\"http://localhost:5000/api/users/user/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});setUsers(users.filter(user=>user._id!==id));}catch(err){setError('An error occurred while deleting the user.');}};const handleEdit=user=>{setEditUser(user);};const handleUpdate=async e=>{e.preventDefault();try{// Get the token from localStorage\nconst token=localStorage.getItem('token');if(!token){setError('No token found, please login.');return;}await axios.put(\"http://localhost:5000/api/users/user/\".concat(editUser._id),editUser,{headers:{Authorization:\"Bearer \".concat(token)}});setUsers(users.map(user=>user._id===editUser._id?editUser:user));setEditUser(null);}catch(err){setError('An error occurred while updating the user.');}};const handleChange=e=>{const{name,value}=e.target;setEditUser(_objectSpread(_objectSpread({},editUser),{},{[name]:value}));};return/*#__PURE__*/_jsxs(\"div\",{className:\"ViewAllUsers\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"All Users\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})// Show loading message while data is being fetched\n:error?/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error})// Display error message if fetching fails\n:/*#__PURE__*/_jsxs(_Fragment,{children:[editUser&&/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleUpdate,children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Name:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",value:editUser.username,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Email:\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:editUser.email,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Update User\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setEditUser(null),children:\"Cancel\"})]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user._id}),/*#__PURE__*/_jsx(\"td\",{children:user.username}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(user),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(user._id),children:\"Delete\"})]})]},user._id))})]})]})]});};export default ViewAllUsers;","map":{"version":3,"names":["React","useEffect","useState","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ViewAllUsers","users","setUsers","loading","setLoading","error","setError","editUser","setEditUser","fetchUsers","token","localStorage","getItem","response","get","headers","Authorization","concat","data","err","handleDelete","id","delete","filter","user","_id","handleEdit","handleUpdate","e","preventDefault","put","map","handleChange","name","value","target","_objectSpread","className","children","onSubmit","type","username","onChange","required","email","onClick"],"sources":["D:/hiru/Hiru-Captial-Investment/frontend/src/pages/ViewAllUsers.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios'; // Import axios for API requests\r\nimport './../css/ViewAllUsers.css'; // Correct path to ViewAllUsers.css\r\n\r\nconst ViewAllUsers = () => {\r\n  // State to hold the users and loading status\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [editUser, setEditUser] = useState(null);\r\n\r\n  // Fetch all users from the backend when the component mounts\r\n  useEffect(() => {\r\n    const fetchUsers = async () => {\r\n      try {\r\n        // Get the token from localStorage\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          setError('No token found, please login.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n\r\n        // Send GET request to the backend with the Authorization header\r\n        const response = await axios.get('http://localhost:5000/api/users/users', {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n        });\r\n        setUsers(response.data); // Store users in the state\r\n        setLoading(false); // Set loading to false when data is fetched\r\n      } catch (err) {\r\n        setError('An error occurred while fetching users.');\r\n        setLoading(false); // Set loading to false even if there's an error\r\n      }\r\n    };\r\n\r\n    fetchUsers();\r\n  }, []); // Empty dependency array ensures the effect runs only once after initial render\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      // Get the token from localStorage\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('No token found, please login.');\r\n        return;\r\n      }\r\n\r\n      await axios.delete(`http://localhost:5000/api/users/user/${id}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      setUsers(users.filter(user => user._id !== id));\r\n    } catch (err) {\r\n      setError('An error occurred while deleting the user.');\r\n    }\r\n  };\r\n\r\n  const handleEdit = (user) => {\r\n    setEditUser(user);\r\n  };\r\n\r\n  const handleUpdate = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      // Get the token from localStorage\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('No token found, please login.');\r\n        return;\r\n      }\r\n\r\n      await axios.put(`http://localhost:5000/api/users/user/${editUser._id}`, editUser, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      setUsers(users.map(user => (user._id === editUser._id ? editUser : user)));\r\n      setEditUser(null);\r\n    } catch (err) {\r\n      setError('An error occurred while updating the user.');\r\n    }\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setEditUser({ ...editUser, [name]: value });\r\n  };\r\n\r\n  return (\r\n    <div className=\"ViewAllUsers\">\r\n      <h1>All Users</h1>\r\n\r\n      {loading ? (\r\n        <p>Loading...</p> // Show loading message while data is being fetched\r\n      ) : error ? (\r\n        <p className=\"error\">{error}</p> // Display error message if fetching fails\r\n      ) : (\r\n        <>\r\n          {editUser && (\r\n            <form onSubmit={handleUpdate}>\r\n              <label>\r\n                Name:\r\n                <input type=\"text\" name=\"username\" value={editUser.username} onChange={handleChange} required />\r\n              </label>\r\n              <label>\r\n                Email:\r\n                <input type=\"email\" name=\"email\" value={editUser.email} onChange={handleChange} required />\r\n              </label>\r\n              <button type=\"submit\">Update User</button>\r\n              <button type=\"button\" onClick={() => setEditUser(null)}>Cancel</button>\r\n            </form>\r\n          )}\r\n          <table>\r\n            <thead>\r\n              <tr>\r\n                <th>ID</th>\r\n                <th>Name</th>\r\n                <th>Email</th>\r\n                <th>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {users.map((user) => (\r\n                <tr key={user._id}>\r\n                  <td>{user._id}</td>\r\n                  <td>{user.username}</td>\r\n                  <td>{user.email}</td>\r\n                  <td>\r\n                    <button onClick={() => handleEdit(user)}>Edit</button>\r\n                    <button onClick={() => handleDelete(user._id)}>Delete</button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ViewAllUsers;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}